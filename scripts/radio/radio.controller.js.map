{"version":3,"sources":["radio/radio.controller.js"],"names":[],"mappings":"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","file":"radio/radio.controller.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular\n        .module('app.radio')\n        .controller('RadioController', RadioController);\n\n    RadioController.$inject = ['$scope',\n        '$rootScope',\n        '$timeout',\n        '$state',\n        '$stateParams',\n        '$log',\n        '$interval',\n        '$sce',\n        '$document',\n        'Icecast',\n        'Track'\n    ];\n\n\n    //TODO: is it safe to use document to choose DOM elements in comparison to angular.element\n\n    /* @ngInject */\n    function RadioController($scope,\n                             $rootScope,\n                             $timeout,\n                             $state,\n                             $stateParams,\n                             $log,\n                             $interval,\n                             $sce,\n                             $document,\n                             Icecast,\n                             Track) {\n\n\n        // For MDL to work\n        // http://stackoverflow.com/questions/31278781/material-design-lite-integration-with-angularjs\n        $scope.$on('$viewContentLoaded', () => {\n            $timeout(() => {\n                componentHandler.upgradeAllRegistered();\n            })\n        });\n        $rootScope.navTitle = 'radio';\n\n        var vm = this;\n\n        //TODO: Must rename these two to sth most appropriate\n        var snackbarContainer = document.querySelector('#snackbar');\n        var handler = function (event) {\n            // showSnackbarButton.style.backgroundColor = '';\n            vm.voteDownDisabled = false;\n        };\n\n        vm.imgUrl = 'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/';\n\n        vm.openMenu = openMenu;\n        vm.openSettings = openSettings;\n        // vm.showPlayer = showPlayer;\n        vm.chlFullTitle = '';\n        vm.slfFullTitle = '';\n        vm.title = '';\n        vm.artist = '';\n\n        // vm.chl = homeResolve.chl;\n        // vm.slf = homeResolve.slf;\n        vm.isBuffering = true;\n        vm.isPlaying = false;\n        vm.play = vm.play;\n        vm.pause = vm.pause;\n        vm.showStyles = false;\n        vm.toggleStyles = toggleStyles;\n\n        vm.showSnackbar = showSnackbar;\n        vm.voteDownDisabled = false;\n        vm.genresDrawerIsVisible = false;\n        vm.hideSidenav = hideSidenav;\n        vm.showPlayer = showPlayer;\n        // vm.hidePlayer = hidePlayer;\n        $rootScope.playerIsFull = false; //player never full at startup\n        $rootScope.headerIsTransparent = false;\n\n        vm.showTuner = showTuner;\n        vm.hideTuner = hideTuner;\n\n\n        vm.covers = [\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/b488229f3931d8843405bfc1998359bd.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/b20af0e974b8ad98d04db3e655f39a25.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/7c86b420bcbd1ba579024c13c086d13c.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/fc33041ca442d2efddd992406401b1e8.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/d07f79afbdf459970d7663ceb189f004.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/c4be736a8aacd2f237445bc7eec32730.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/a17cc0cb2a60ae8eb2dfd13e4b60542c.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/693e9af84d3dfcc71e640e005bdc5e2e.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/36bb368aafe7b2e40c90d16c056a722e.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/532089d6b7aff7b98b80eba86ff35dee.jpeg'\n        ];\n\n\n        $interval(checkNowPlaying, 3000);\n\n        //console.log(homeResolve);\n        // vm.audio = angular.element(document.getElementsByTagName('audio')[0]);\n        vm.audio = document.getElementsByTagName('audio')[0];\n\n        // vm.audio.addEventListener('canplay', function() {\n        //     vm.isBuffering = false;\n        //     vm.isPlaying = true;\n        // }, false);\n\n\n        vm.play = function () {\n            vm.audio.play();\n            vm.isPlaying = true;\n        };\n\n        vm.pause = function () {\n            vm.audio.pause();\n            vm.isPlaying = false;\n        };\n\n        function showPlayer() {\n            $rootScope.playerIsVisible = true;\n        }\n\n        function showTuner() {\n            $rootScope.tunerIsVisible = true;\n        }\n\n        function hideTuner() {\n            $rootScope.tunerIsVisible = false;\n        }\n\n\n        function hideSidenav() {\n            angular\n                .element(document.querySelector('.smx-sidenav'))\n                .removeClass('is-visible');\n            angular\n                .element(document.querySelector('.mdl-layout__obfuscator'))\n                .removeClass('is-visible');\n\n        }\n\n        function showSnackbar() {\n\n            if (vm.voteDownDisabled) return;\n\n            var data = {\n                message: 'Track was voted down',\n                timeout: 2000,\n                actionHandler: handler,\n                actionText: 'Undo'\n            };\n            snackbarContainer.MaterialSnackbar.showSnackbar(data);\n            vm.voteDownDisabled = true;\n\n        }\n\n\n        // function showPlayer($event, radioChannel) {\n        //\n        //     var nowPlayingInfo;\n        //\n        //     switch (radioChannel) {\n        //         // case 'chl':\n        //         //     nowPlayingInfo = vm.chl;\n        //         //     break;\n        //         case 'slf':\n        //             nowPlayingInfo = vm.slf;\n        //             break;\n        //         default:\n        //             break;\n        //     }\n        //\n        //     // $mdDialog.show({\n        //     //     parent: angular.element(document.body),\n        //     //     targetEvent: $event,\n        //     //     templateUrl: '/scripts/player/player.tmpl.html',\n        //     //     locals: {\n        //     //         radioChannel: radioChannel,\n        //     //         nowPlaying: nowPlayingInfo\n        //     //     },\n        //     //     controller: 'PlayerController as vm',\n        //     //     fullscreen: true\n        //     // });\n        //\n        // }\n\n        function openMenu() {\n            $mdSidenav('sidenav').toggle();\n        }\n\n        function openSettings() {\n            $mdSidenav('settingsnav').toggle();\n        }\n\n        function toggleStyles() {\n            vm.showStyles = !vm.showStyles;\n        }\n\n        function checkNowPlaying() {\n\n            Icecast.nowPlaying().then(function (data) {\n\n                // if (vm.chlFullTitle !== data.icestats.source[0].title) {\n                //     vm.chlFullTitle = data.icestats.source[0].title;\n                //     getTrackInfo('chl', vm.chlFullTitle);\n                // }\n\n                if (vm.slfFullTitle !== data.icestats.source[1].title) {\n                    vm.slfFullTitle = data.icestats.source[1].title;\n                    //\n                    vm.title = vm.slfFullTitle.split('__')[0];\n                    vm.artist = vm.slfFullTitle.split('__')[1];\n                    console.log(vm.slfFullTitle, vm.title, vm.artist);\n                    //\n                    getTrackInfo('slf', vm.slfFullTitle);\n                }\n\n            });\n\n        }\n\n        function getTrackInfo(radioChannel, fullTitle) {\n\n            var fullTitleArr = fullTitle.split('__');\n            var coverUrl;\n\n            Track.trackInfo(fullTitleArr[0], fullTitleArr[1], fullTitleArr[2]).then(function (info) {\n\n                if (info[0]) {\n                    coverUrl = 'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/' + info[0].cover;\n                }\n\n                switch (radioChannel) {\n                    // case 'chl':\n                    //     vm.chl = info[0];\n                    //     vm.chl.coverUrl = coverUrl;\n                    //     break;\n                    case 'slf':\n                        vm.slf = info[0];\n                        if (info[0]) {\n                            vm.slf.coverUrl = coverUrl;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n\n            });\n\n        }\n\n    }\n\n\n})();\n"],"sourceRoot":"/source/"}