{"version":3,"sources":["home/home.controller.js"],"names":[],"mappings":"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","file":"home/home.controller.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular\n        .module('app.home')\n        .controller('HomeController', HomeController);\n\n    HomeController.$inject = ['$scope',\n        '$timeout',\n        // '$mdSidenav',\n        '$log',\n        '$interval',\n        '$sce',\n        '$document',\n        // '$mdDialog',\n        // '$mdMedia',\n        'Icecast',\n        'Track',\n        'homeResolve'\n    ];\n\n\n    //TODO: is it safe to use document to choose DOM elements in comparison to angular.element\n\n    /* @ngInject */\n    function HomeController($scope,\n                            $timeout,\n                            // $mdSidenav,\n                            $log,\n                            $interval,\n                            $sce,\n                            $document,\n                            // $mdDialog,\n                            // $mdMedia,\n                            Icecast,\n                            Track,\n                            homeResolve) {\n\n\n        // For MDL to work\n        // http://stackoverflow.com/questions/31278781/material-design-lite-integration-with-angularjs\n        $scope.$on('$viewContentLoaded', () => {\n            $timeout(() => {\n                componentHandler.upgradeAllRegistered();\n            })\n        });\n\n        var vm = this;\n\n        //TODO: Must rename these two to sth most appropriate\n        var snackbarContainer = document.querySelector('#snackbar');\n        var handler = function(event) {\n            // showSnackbarButton.style.backgroundColor = '';\n            vm.voteDownDisabled = false;\n        };\n\n\n\n        vm.imgUrl = 'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/';\n\n        vm.openMenu = openMenu;\n        vm.openSettings = openSettings;\n        vm.showPlayer = showPlayer;\n        vm.chlFullTitle = '';\n        vm.slfFullTitle = '';\n        // vm.chl = homeResolve.chl;\n        vm.slf = homeResolve.slf;\n        vm.isBuffering = true;\n        vm.isPlaying = false;\n        vm.play = vm.play;\n        vm.pause = vm.pause;\n        vm.showStyles = false;\n        vm.toggleStyles = toggleStyles;\n\n        vm.showSnackbar = showSnackbar;\n        vm.voteDownDisabled = false;\n        vm.genresDrawerIsVisible = false;\n        vm.hideSidenav = hideSidenav;\n\n\n        vm.covers= [\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/b488229f3931d8843405bfc1998359bd.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/b20af0e974b8ad98d04db3e655f39a25.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/7c86b420bcbd1ba579024c13c086d13c.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/fc33041ca442d2efddd992406401b1e8.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/d07f79afbdf459970d7663ceb189f004.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/c4be736a8aacd2f237445bc7eec32730.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/a17cc0cb2a60ae8eb2dfd13e4b60542c.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/693e9af84d3dfcc71e640e005bdc5e2e.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/36bb368aafe7b2e40c90d16c056a722e.jpeg',\n            'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/532089d6b7aff7b98b80eba86ff35dee.jpeg'\n        ];\n\n\n\n\n\n        $interval(checkNowPlaying, 3000);\n\n        //console.log(homeResolve);\n        // vm.audio = angular.element(document.getElementsByTagName('audio')[0]);\n        vm.audio = document.getElementsByTagName('audio')[0];\n\n        // vm.audio.addEventListener('canplay', function() {\n        //     vm.isBuffering = false;\n        //     vm.isPlaying = true;\n        // }, false);\n\n\n        vm.play = function() {\n            vm.audio.play();\n            vm.isPlaying = true;\n        };\n\n        vm.pause = function() {\n            vm.audio.pause();\n            vm.isPlaying = false;\n        };\n\n        function hideSidenav() {\n            angular\n                .element( document.querySelector('.smx-sidenav') )\n                .removeClass('is-visible');\n            angular\n                .element( document.querySelector('.mdl-layout__obfuscator') )\n                .removeClass('is-visible');\n\n        }\n\n        function showSnackbar() {\n\n            if (vm.voteDownDisabled) return;\n\n            var data = {\n                message: 'Track was voted down',\n                timeout: 2000,\n                actionHandler: handler,\n                actionText: 'Undo'\n            };\n            snackbarContainer.MaterialSnackbar.showSnackbar(data);\n            vm.voteDownDisabled = true;\n\n        }\n\n\n        function showPlayer($event, radioChannel) {\n\n            var nowPlayingInfo;\n\n            switch (radioChannel) {\n                // case 'chl':\n                //     nowPlayingInfo = vm.chl;\n                //     break;\n                case 'slf':\n                    nowPlayingInfo = vm.slf;\n                    break;\n                default:\n                    break;\n            }\n\n            // $mdDialog.show({\n            //     parent: angular.element(document.body),\n            //     targetEvent: $event,\n            //     templateUrl: '/scripts/player/player.tmpl.html',\n            //     locals: {\n            //         radioChannel: radioChannel,\n            //         nowPlaying: nowPlayingInfo\n            //     },\n            //     controller: 'PlayerController as vm',\n            //     fullscreen: true\n            // });\n\n        }\n\n        function openMenu() {\n            $mdSidenav('sidenav').toggle();\n        }\n\n        function openSettings() {\n            $mdSidenav('settingsnav').toggle();\n        }\n\n        function toggleStyles() {\n            vm.showStyles = !vm.showStyles;\n        }\n\n        function checkNowPlaying() {\n\n            Icecast.nowPlaying().then(function (data) {\n\n                // if (vm.chlFullTitle !== data.icestats.source[0].title) {\n                //     vm.chlFullTitle = data.icestats.source[0].title;\n                //     getTrackInfo('chl', vm.chlFullTitle);\n                // }\n\n                if (vm.slfFullTitle !== data.icestats.source[1].title) {\n                    vm.slfFullTitle = data.icestats.source[1].title;\n                    getTrackInfo('slf', vm.slfFullTitle);\n                }\n\n            });\n\n        }\n\n        function getTrackInfo(radioChannel, fullTitle) {\n\n            var fullTitleArr = fullTitle.split('__');\n            var coverUrl;\n\n            Track.trackInfo(fullTitleArr[0], fullTitleArr[1], fullTitleArr[2]).then(function (info) {\n\n                if (info[0]) {\n                    coverUrl = 'https://s3.eu-central-1.amazonaws.com/smx-static/RaiNAS_1/RaiNAS/music/live/covers/' + info[0].cover;\n                }\n\n                switch (radioChannel) {\n                    // case 'chl':\n                    //     vm.chl = info[0];\n                    //     vm.chl.coverUrl = coverUrl;\n                    //     break;\n                    case 'slf':\n                        vm.slf = info[0];\n                        if (info[0]) {\n                            vm.slf.coverUrl = coverUrl;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n\n            });\n\n        }\n\n    }\n\n\n})();\n"],"sourceRoot":"/source/"}